<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Register - SanoCare AI Health Assistant</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet">
    <style>
        .form-section {
            margin-bottom: 2rem;
            padding: 1.5rem;
            border-radius: 8px;
            background-color: #f8f9fa;
        }
        .section-title {
            color: #2c3e50;
            margin-bottom: 1.5rem;
            font-weight: 600;
        }
        .required::after {
            content: " *";
            color: red;
        }
        .select2-container {
            width: 100% !important;
        }
        .form-check {
            margin-bottom: 0.5rem;
        }
        .cultural-practices {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }
        .practice-card {
            padding: 1rem;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            background-color: white;
        }
        .practice-card:hover {
            border-color: #0d6efd;
            cursor: pointer;
        }
        .practice-card.selected {
            border-color: #0d6efd;
            background-color: #e7f1ff;
        }
    </style>
</head>
<body>
    <div class="container py-5">
        <h1 class="text-center mb-5">Create Your SanoCare Account</h1>
        
        <form id="registrationForm" class="needs-validation" novalidate>
            <!-- Basic Information Section -->
            <div class="form-section">
                <h3 class="section-title">Basic Information</h3>
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label for="username" class="form-label required">Username</label>
                        <input type="text" class="form-control" id="username" name="username" required>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label for="email" class="form-label required">Email</label>
                        <input type="email" class="form-control" id="email" name="email" required>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label for="password" class="form-label required">Password</label>
                        <input type="password" class="form-control" id="password" name="password" required>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label for="confirmPassword" class="form-label required">Confirm Password</label>
                        <input type="password" class="form-control" id="confirmPassword" name="confirmPassword" required>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label for="dateOfBirth" class="form-label required">Date of Birth</label>
                        <input type="date" class="form-control" id="dateOfBirth" name="date_of_birth" required>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label for="gender" class="form-label required">Gender</label>
                        <select class="form-select" id="gender" name="gender" required>
                            <option value="">Select gender</option>
                            <option value="male">Male</option>
                            <option value="female">Female</option>
                            <option value="other">Other</option>
                            <option value="prefer_not_to_say">Prefer not to say</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- Cultural Background Section -->
            <div class="form-section">
                <h3 class="section-title">Cultural Background</h3>
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label for="ethnicity" class="form-label required">Ethnicity</label>
                        <select class="form-select" id="ethnicity" name="ethnicity" required>
                            <option value="">Select ethnicity</option>
                            <option value="asian">Asian</option>
                            <option value="african">African</option>
                            <option value="caucasian">Caucasian</option>
                            <option value="hispanic">Hispanic</option>
                            <option value="indian">Indian</option>
                            <option value="middle_eastern">Middle Eastern</option>
                            <option value="native_american">Native American</option>
                            <option value="pacific_islander">Pacific Islander</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label for="religion" class="form-label">Religion</label>
                        <select class="form-select" id="religion" name="religion">
                            <option value="">Select religion</option>
                            <option value="buddhism">Buddhism</option>
                            <option value="christianity">Christianity</option>
                            <option value="hinduism">Hinduism</option>
                            <option value="islam">Islam</option>
                            <option value="judaism">Judaism</option>
                            <option value="sikhism">Sikhism</option>
                            <option value="other">Other</option>
                            <option value="none">None</option>
                        </select>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label for="language" class="form-label required">Preferred Language</label>
                        <select class="form-select" id="language" name="language_preference" required>
                            <option value="en">English</option>
                            <option value="es">Spanish</option>
                            <option value="fr">French</option>
                            <option value="de">German</option>
                            <option value="hi">Hindi</option>
                            <option value="zh">Chinese</option>
                            <option value="ja">Japanese</option>
                            <option value="ko">Korean</option>
                        </select>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label for="region" class="form-label required">Region</label>
                        <select class="form-select" id="region" name="region" required>
                            <option value="">Select region</option>
                            <option value="north_america">North America</option>
                            <option value="south_america">South America</option>
                            <option value="europe">Europe</option>
                            <option value="asia">Asia</option>
                            <option value="africa">Africa</option>
                            <option value="oceania">Oceania</option>
                        </select>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label for="country" class="form-label required">Country</label>
                        <select class="form-select" id="country" name="country_code" required>
                            <option value="">Select country</option>
                            <!-- Will be populated dynamically based on region -->
                        </select>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label for="city" class="form-label">City</label>
                        <input type="text" class="form-control" id="city" name="city">
                    </div>
                </div>
            </div>

            <!-- Cultural Practices Section -->
            <div class="form-section">
                <h3 class="section-title">Cultural Practices & Health Beliefs</h3>
                
                <!-- Dietary Restrictions -->
                <div class="mb-4">
                    <label class="form-label">Dietary Restrictions</label>
                    <div class="cultural-practices">
                        <div class="practice-card" data-value="vegetarian">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" name="dietary_restrictions" value="vegetarian" id="vegetarian">
                                <label class="form-check-label" for="vegetarian">Vegetarian</label>
                            </div>
                        </div>
                        <div class="practice-card" data-value="vegan">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" name="dietary_restrictions" value="vegan" id="vegan">
                                <label class="form-check-label" for="vegan">Vegan</label>
                            </div>
                        </div>
                        <div class="practice-card" data-value="halal">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" name="dietary_restrictions" value="halal" id="halal">
                                <label class="form-check-label" for="halal">Halal</label>
                            </div>
                        </div>
                        <div class="practice-card" data-value="kosher">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" name="dietary_restrictions" value="kosher" id="kosher">
                                <label class="form-check-label" for="kosher">Kosher</label>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Traditional Medicine -->
                <div class="mb-4">
                    <label class="form-label">Traditional Medicine Preferences</label>
                    <div class="cultural-practices">
                        <div class="practice-card" data-value="ayurveda">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" name="traditional_medicine_preferences" value="ayurveda" id="ayurveda">
                                <label class="form-check-label" for="ayurveda">Ayurveda</label>
                            </div>
                        </div>
                        <div class="practice-card" data-value="tcm">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" name="traditional_medicine_preferences" value="tcm" id="tcm">
                                <label class="form-check-label" for="tcm">Traditional Chinese Medicine</label>
                            </div>
                        </div>
                        <div class="practice-card" data-value="homeopathy">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" name="traditional_medicine_preferences" value="homeopathy" id="homeopathy">
                                <label class="form-check-label" for="homeopathy">Homeopathy</label>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Spiritual Practices -->
                <div class="mb-4">
                    <label class="form-label">Spiritual Practices</label>
                    <div class="cultural-practices">
                        <div class="practice-card" data-value="meditation">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" name="spiritual_practices" value="meditation" id="meditation">
                                <label class="form-check-label" for="meditation">Meditation</label>
                            </div>
                        </div>
                        <div class="practice-card" data-value="yoga">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" name="spiritual_practices" value="yoga" id="yoga">
                                <label class="form-check-label" for="yoga">Yoga</label>
                            </div>
                        </div>
                        <div class="practice-card" data-value="prayer">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" name="spiritual_practices" value="prayer" id="prayer">
                                <label class="form-check-label" for="prayer">Prayer</label>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Wellness Rituals -->
                <div class="mb-4">
                    <label class="form-label">Wellness Rituals</label>
                    <div class="cultural-practices">
                        <div class="practice-card" data-value="fasting">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" name="wellness_rituals" value="fasting" id="fasting">
                                <label class="form-check-label" for="fasting">Fasting</label>
                            </div>
                        </div>
                        <div class="practice-card" data-value="herbal_remedies">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" name="wellness_rituals" value="herbal_remedies" id="herbal_remedies">
                                <label class="form-check-label" for="herbal_remedies">Herbal Remedies</label>
                            </div>
                        </div>
                        <div class="practice-card" data-value="mindfulness">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" name="wellness_rituals" value="mindfulness" id="mindfulness">
                                <label class="form-check-label" for="mindfulness">Mindfulness</label>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Family Context Section -->
            <div class="form-section">
                <h3 class="section-title">Family Context</h3>
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label for="familyStructure" class="form-label required">Family Structure</label>
                        <select class="form-select" id="familyStructure" name="family_structure" required>
                            <option value="">Select family structure</option>
                            <option value="nuclear">Nuclear Family</option>
                            <option value="extended">Extended Family</option>
                            <option value="joint">Joint Family</option>
                            <option value="single_parent">Single Parent</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label for="healthDecisionMaking" class="form-label required">Health Decision Making</label>
                        <select class="form-select" id="healthDecisionMaking" name="health_decision_making" required>
                            <option value="">Select decision making style</option>
                            <option value="individual">Individual</option>
                            <option value="family">Family</option>
                            <option value="community">Community</option>
                            <option value="mixed">Mixed</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- Health Information Section -->
            <div class="form-section">
                <h3 class="section-title">Health Information</h3>
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label for="bloodType" class="form-label">Blood Type</label>
                        <select class="form-select" id="bloodType" name="blood_type">
                            <option value="">Select blood type</option>
                            <option value="A+">A+</option>
                            <option value="A-">A-</option>
                            <option value="B+">B+</option>
                            <option value="B-">B-</option>
                            <option value="AB+">AB+</option>
                            <option value="AB-">AB-</option>
                            <option value="O+">O+</option>
                            <option value="O-">O-</option>
                        </select>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label for="allergies" class="form-label">Allergies</label>
                        <input type="text" class="form-control" id="allergies" name="allergies" placeholder="Comma-separated list">
                    </div>
                    <div class="col-md-6 mb-3">
                        <label for="chronicConditions" class="form-label">Chronic Conditions</label>
                        <input type="text" class="form-control" id="chronicConditions" name="chronic_conditions" placeholder="Comma-separated list">
                    </div>
                    <div class="col-md-6 mb-3">
                        <label for="medications" class="form-label">Current Medications</label>
                        <input type="text" class="form-control" id="medications" name="medications" placeholder="Comma-separated list">
                    </div>
                </div>
            </div>

            <!-- Emergency Contact Section -->
            <div class="form-section">
                <h3 class="section-title">Emergency Contact</h3>
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label for="emergencyName" class="form-label required">Emergency Contact Name</label>
                        <input type="text" class="form-control" id="emergencyName" name="emergency_contact[name]" required>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label for="emergencyPhone" class="form-label required">Emergency Contact Phone</label>
                        <input type="tel" class="form-control" id="emergencyPhone" name="emergency_contact[phone]" required>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label for="emergencyRelation" class="form-label required">Relationship</label>
                        <input type="text" class="form-control" id="emergencyRelation" name="emergency_contact[relation]" required>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label for="emergencyEmail" class="form-label">Email</label>
                        <input type="email" class="form-control" id="emergencyEmail" name="emergency_contact[email]">
                    </div>
                </div>
            </div>

            <div class="text-center mt-4">
                <button type="submit" class="btn btn-primary btn-lg">Create Account</button>
            </div>
        </form>
    </div>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
    <script>
        $(document).ready(function() {
            // Initialize Select2
            $('.form-select').select2({
                theme: 'bootstrap-5'
            });

            // Handle practice card selection
            $('.practice-card').click(function() {
                const checkbox = $(this).find('input[type="checkbox"]');
                checkbox.prop('checked', !checkbox.prop('checked'));
                $(this).toggleClass('selected');
            });

            // Handle form submission
            $('#registrationForm').submit(function(e) {
                e.preventDefault();
                
                // Validate form
                if (!this.checkValidity()) {
                    e.stopPropagation();
                    $(this).addClass('was-validated');
                    return;
                }

                // Collect form data
                const formData = {};
                $(this).serializeArray().forEach(item => {
                    if (item.name.includes('[')) {
                        // Handle nested objects (like emergency_contact)
                        const [parent, child] = item.name.split('[');
                        const key = child.slice(0, -1);
                        if (!formData[parent]) {
                            formData[parent] = {};
                        }
                        formData[parent][key] = item.value;
                    } else {
                        formData[item.name] = item.value;
                    }
                });

                // Handle arrays (checkboxes)
                $('input[type="checkbox"]:checked').each(function() {
                    const name = $(this).attr('name');
                    if (!formData[name]) {
                        formData[name] = [];
                    }
                    formData[name].push($(this).val());
                });

                // Send registration request
                $.ajax({
                    url: '/register',
                    method: 'POST',
                    contentType: 'application/json',
                    data: JSON.stringify(formData),
                    success: function(response) {
                        if (response.success) {
                            // Redirect to dashboard or show success message
                            window.location.href = '/dashboard';
                        } else {
                            alert(response.message || 'Registration failed. Please try again.');
                        }
                    },
                    error: function(xhr) {
                        alert('An error occurred. Please try again.');
                    }
                });
            });

            // Populate countries based on region
            $('#region').change(function() {
                const region = $(this).val();
                const countrySelect = $('#country');
                countrySelect.empty();

                // Add countries based on region
                const countries = {
                    'north_america': ['US', 'CA', 'MX'],
                    'south_america': ['BR', 'AR', 'CO'],
                    'europe': ['GB', 'FR', 'DE', 'IT', 'ES'],
                    'asia': ['IN', 'CN', 'JP', 'KR', 'SG'],
                    'africa': ['ZA', 'EG', 'NG', 'KE'],
                    'oceania': ['AU', 'NZ']
                };

                if (countries[region]) {
                    countries[region].forEach(code => {
                        countrySelect.append(new Option(code, code));
                    });
                }
            });
        });
    </script>
</body>
</html> 